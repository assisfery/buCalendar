var buCalendar={};buCalendar.calendars=[{name:"Google",baseUrl:"https://calendar.google.com/calendar/render?",queryStringParams:"action=TEMPLATE&text={NAME}&details={DETAILS}&dates={START_DATE}/{END_DATE}&location={LOCATION}",datetimeFormat:"YYYYMMDDTHHmmss"},{name:"Yahoo",baseUrl:"https://calendar.yahoo.com/?",queryStringParams:"v=60&TITLE={NAME}&DESC={DETAILS}&ST={START_DATE}&ET={END_DATE}&in_loc={LOCATION}",datetimeFormat:"YYYYMMDDTHHmmss"},{name:"Outlook",baseUrl:"https://outlook.live.com/calendar/0/deeplink/compose?",queryStringParams:"path=/calendar/action/compose&rru=addevent&subject={NAME}&body={DETAILS}&startdt={START_DATE}&enddt={END_DATE}&location={LOCATION}",datetimeFormat:"YYYY-MM-DDTHH:mm:ss"},{name:"Office 365",baseUrl:"https://outlook.office.com/calendar/0/deeplink/compose?",queryStringParams:"path=/calendar/action/compose&rru=addevent&subject={NAME}&body={DETAILS}&startdt={START_DATE}&enddt={END_DATE}&location={LOCATION}",datetimeFormat:"YYYY-MM-DDTHH:mm:ss"},],buCalendar.setup=function(g,h,b,i=""){for(var f=document.querySelectorAll(g),e=0;e<f.length;e++)for(var a=0;a<b.length;a++)for(var d=0;d<buCalendar.calendars.length;d++)if(b[a].name==buCalendar.calendars[d].name){var c=document.createElement("a");c.setAttribute("class","bc-link "+(i||"")),c.setAttribute("href",buCalendar.getUrl(h,b[a],buCalendar.calendars[d])),c.setAttribute("target","_blank"),b[a].content?c.innerHTML=b[a].content:c.innerHTML=b[a].name,f[e].appendChild(c)}},buCalendar.getUrl=function(a,c,b){return(b.baseUrl+b.queryStringParams).replace("{NAME}",encodeURIComponent(a.name)).replace("{DETAILS}",encodeURIComponent(a.details?a.details:"")).replace("{START_DATE}",encodeURIComponent(moment(a.startDate).format(b.datetimeFormat)+"Z")).replace("{END_DATE}",encodeURIComponent(moment(a.endDate).format(b.datetimeFormat)+"Z")).replace("{LOCATION}",encodeURIComponent(a.location?a.location:""))+(c.addQueryString?c.addQueryString:"")}