var buCalendar={calendars:[{name:"Google",baseUrl:"https://calendar.google.com/calendar/render?",queryStringParams:"action=TEMPLATE&text={NAME}&details={DETAILS}&dates={START_DATE}/{END_DATE}&location={LOCATION}",datetimeFormat:"YYYYMMDDTHHmmss"},{name:"Yahoo",baseUrl:"https://calendar.yahoo.com/?",queryStringParams:"v=60&TITLE={NAME}&DESC={DETAILS}&ST={START_DATE}&ET={END_DATE}&in_loc={LOCATION}",datetimeFormat:"YYYYMMDDTHHmmss"},{name:"Outlook",baseUrl:"https://outlook.live.com/calendar/0/deeplink/compose?",queryStringParams:"path=/calendar/action/compose&rru=addevent&subject={NAME}&body={DETAILS}&startdt={START_DATE}&enddt={END_DATE}&location={LOCATION}",datetimeFormat:"YYYY-MM-DDTHH:mm:ss"},{name:"Office 365",baseUrl:"https://outlook.office.com/calendar/0/deeplink/compose?",queryStringParams:"path=/calendar/action/compose&rru=addevent&subject={NAME}&body={DETAILS}&startdt={START_DATE}&enddt={END_DATE}&location={LOCATION}",datetimeFormat:"YYYY-MM-DDTHH:mm:ss"}],setup:function(e,a,t,n=""){for(var r=document.querySelectorAll(e),o=0;o<r.length;o++)for(var l=0;l<t.length;l++)for(var d=0;d<buCalendar.calendars.length;d++)if(t[l].name==buCalendar.calendars[d].name){var m=document.createElement("a");m.setAttribute("class","bc-link "+(n||"")),m.setAttribute("href",buCalendar.getUrl(a,t[l],buCalendar.calendars[d])),m.setAttribute("target","_blank"),t[l].content?m.innerHTML=t[l].content:m.innerHTML=t[l].name,r[o].appendChild(m)}},getUrl:function(e,a,t){return(t.baseUrl+t.queryStringParams).replace("{NAME}",encodeURIComponent(e.name)).replace("{DETAILS}",encodeURIComponent(e.details?e.details:"")).replace("{START_DATE}",encodeURIComponent(moment(e.startDate).format(t.datetimeFormat)+"Z")).replace("{END_DATE}",encodeURIComponent(moment(e.endDate).format(t.datetimeFormat)+"Z")).replace("{LOCATION}",encodeURIComponent(e.location?e.location:""))+(a.addQueryString?a.addQueryString:"")}};