var buCalendar={calendars:[{name:"Google",baseUrl:"https://calendar.google.com/calendar/render?",queryStringParams:"action=TEMPLATE&text={NAME}&details={DETAILS}&dates={START_DATE}/{END_DATE}&location={LOCATION}",datetimeFormat:"YYYYMMDDTHHmmss"},{name:"Yahoo",baseUrl:"https://calendar.yahoo.com/?",queryStringParams:"v=60&TITLE={NAME}&DESC={DETAILS}&ST={START_DATE}&ET={END_DATE}&in_loc={LOCATION}",datetimeFormat:"YYYYMMDDTHHmmss"},{name:"Outlook",baseUrl:"https://outlook.live.com/calendar/0/deeplink/compose?",queryStringParams:"path=/calendar/action/compose&rru=addevent&subject={NAME}&body={DETAILS}&startdt={START_DATE}&enddt={END_DATE}&location={LOCATION}",datetimeFormat:"YYYY-MM-DDTHH:mm:ss"},{name:"Office 365",baseUrl:"https://outlook.office.com/calendar/0/deeplink/compose?",queryStringParams:"path=/calendar/action/compose&rru=addevent&subject={NAME}&body={DETAILS}&startdt={START_DATE}&enddt={END_DATE}&location={LOCATION}",datetimeFormat:"YYYY-MM-DDTHH:mm:ss"},{name:"ICS file",type:"ics",datetimeFormat:"YYYYMMDDTHHmmss",downloadTemplate:"BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\nDTSTART:{START_DATE}\nDTEND:{END_DATE}\nSUMMARY:{NAME}\nDESCRIPTION:{DETAILS}\nLOCATION:{LOCATION}\nEND:VEVENT\nEND:VCALENDAR"}],setup:function(e,a,t,n=""){for(var r=document.querySelectorAll(e),o=0;o<r.length;o++)for(var d=0;d<t.length;d++)for(var l=0;l<buCalendar.calendars.length;l++)if(t[d].name==buCalendar.calendars[l].name){var c=document.createElement("a");c.setAttribute("class","bc-link "+(n||"")),"ics"==buCalendar.calendars[l].type?(buCalendar.cacheICSCalendarType=buCalendar.calendars[l],c.setAttribute("href","#"),c.addEventListener("click",(function(){buCalendar.download("invite.ics",buCalendar.cacheICSCalendarType.downloadTemplate.replace("{START_DATE}",moment(a.startDate).format(buCalendar.cacheICSCalendarType.datetimeFormat)+"Z").replace("{END_DATE}",moment(a.endDate).format(buCalendar.cacheICSCalendarType.datetimeFormat)+"Z").replace("{NAME}",a.name).replace("{DETAILS}",a.details).replace("{LOCATION}",a.location))}))):(c.setAttribute("href",buCalendar.getUrl(a,t[d],buCalendar.calendars[l])),c.setAttribute("target","_blank")),t[d].content?c.innerHTML=t[d].content:c.innerHTML=t[d].name,r[o].appendChild(c)}},getUrl:function(e,a,t){return(t.baseUrl+t.queryStringParams).replace("{NAME}",encodeURIComponent(e.name)).replace("{DETAILS}",encodeURIComponent(e.details?e.details:"")).replace("{START_DATE}",encodeURIComponent(moment(e.startDate).format(t.datetimeFormat)+"Z")).replace("{END_DATE}",encodeURIComponent(moment(e.endDate).format(t.datetimeFormat)+"Z")).replace("{LOCATION}",encodeURIComponent(e.location?e.location:""))+(a.addQueryString?a.addQueryString:"")},download:function(e,a){var t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(a)),t.setAttribute("download",e),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}};